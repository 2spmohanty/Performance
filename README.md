
# vCenter Concurrent Operations. 

## Do You Know.

These are the stats generated by this framework on how vCenter concurrent operation works. What would be your ideal concurrency?

This experiment was done on :
## VM Configuration:
Ubuntu 16.04

Once powered on this VM will start consuming ~8 - 9  GB of memory.

The total memory for this VM is 12 GB.

To mimic real world dirty memory, we occupy the memory with Normal Distribution of mean 8 GB and standard deviation of 100 MB.

This means, this VM will always occupy memory of around 8 GB (plus/minus 100 MB).

This Test VM has single disk of 100 GB.


##  Host Configuration
Model:PowerEdge R740
Processor Type:Intel(R) Xeon(R) Gold 5218 CPU @ 2.30GHz
Logical Processors:64
NICs: 2 (10 Gb/s) One for management and one for vMotion.
Memory: 190.46 GB

## Observation

vMotion:
```
Host Concurrency: 8         Time To Complete: 5 Min 02 Sec.

Host Concurrency: 4         Time To Complete: 3 Min 25 Sec.

Host Concurrency: 2         Time To Complete: 3 Min 57 Sec.

Host Concurrency: 1         Time To Complete: 4 Min 12 Sec.
```

### If vMotion is Done with 4 concurrency, then it is most effective.



# Operation Performance

This framework provides a concurrent framework to do vCenter specific Operation. Not only it completes the operation but also it plots resource usage of vCenter Host objects involved in Operation.

The resource usage provides useful stats which can be beneficial data, which can be utilized to determine the ideal number of concurrent operation for a specific task.

For example the below image displays the result of 16 VM Concurrent Cloning Operation.

![16 VM Concurrent Cloning Operation](https://raw.githubusercontent.com/2spmohanty/Performance/master/images/16_16_Ops.png)

The below image depicts the resource usage aswell as time taken if the Operation would have proceeded sequentially.

![16 VM Sequential Migrate Operation](https://raw.githubusercontent.com/2spmohanty/Performance/master/images/16_1_ops.png)

The below image generated from framework shows the duration, bandwidth during a 8 concurrent process.

![8 Concurrent vMotion](https://raw.githubusercontent.com/2spmohanty/Performance/master/images/8_Concur.png)


# How to Run.

An Input text file needs to be created in the following formatt. 
The format is :

OPSName-Instance-PARAMETER=VALUE

The * in instance value indicates that it is applicable to all instance.

```
CloneOps-*-PRIMARY_LDU_NAME=52.32.13.1
CloneOps-*-PRIMARY_LDU_USER_NAME=administrator@vsphere.local
CloneOps-*-PRIMARY_LDU_PASSWD=YellowMellow!



CloneOps-*-STAT_COLLLECTION_LIST=pnic,datastore

CloneOps-*-DATACENTER=Datacenter3


CloneOps-*-CLUSTER=cloud_cluster_3
CloneOps-*-HOST_NAME=w1-hs4-n2201.eng.vmware.com
CloneOps-*-SRC_PNIC=vmnic0


CloneOps-*-DEST_CLUSTER=cloud_cluster_4
CloneOps-*-DEST_HOST_NAME=w1-hs4-n2206.eng.vmware.com
CloneOps-*-PNIC=vmnic0

CloneOps-1-SRC_VM_NAME=Test-VM-17
CloneOps-1-VM_NAME=Test-VM-33
CloneOps-1-DATASTORE=Local-2201-2
CloneOps-1-DEST_DATASTORE=Local-2206-1

CloneOps-2-SRC_VM_NAME=Test-VM-18
CloneOps-2-VM_NAME=Test-VM-34
CloneOps-2-DATASTORE=Local-2201-2
CloneOps-2-DEST_DATASTORE=Local-2206-1
```

##Run:

```
python concurrencytrigger.py -f '/Performance/framework/data/3.txt' -o CreateVmOps -t 16 -d
```

The -f parameter indicates the input file and -t indicates the number of concurrent process.
